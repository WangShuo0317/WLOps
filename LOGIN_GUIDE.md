# ç”¨æˆ·ç™»å½•åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## âœ… å·²å®ç°çš„åŠŸèƒ½

### åç«¯åŠŸèƒ½
1. **ç”¨æˆ·æ³¨å†Œ** - POST /api/auth/register
2. **ç”¨æˆ·ç™»å½•** - POST /api/auth/login
3. **è·å–ç”¨æˆ·ä¿¡æ¯** - GET /api/auth/me
4. **ç”¨æˆ·ç™»å‡º** - POST /api/auth/logout

### å‰ç«¯åŠŸèƒ½
1. **ç™»å½•é¡µé¢** - `/login`
2. **æ³¨å†ŒåŠŸèƒ½** - åœ¨ç™»å½•é¡µé¢åˆ‡æ¢æ ‡ç­¾
3. **è·¯ç”±å®ˆå«** - æœªç™»å½•è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ
4. **ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º** - é¡¶éƒ¨æ˜¾ç¤ºå½“å‰ç”¨æˆ·
5. **ç™»å‡ºåŠŸèƒ½** - ç‚¹å‡»ç”¨æˆ·å¤´åƒä¸‹æ‹‰èœå•

### æ•°æ®éš”ç¦»
- æ‰€æœ‰æ•°æ®é›†å’Œä»»åŠ¡éƒ½å…³è”åˆ°ç™»å½•ç”¨æˆ·
- ç”¨æˆ·åªèƒ½çœ‹åˆ°å’Œæ“ä½œè‡ªå·±çš„æ•°æ®
- æ–‡ä»¶å­˜å‚¨æŒ‰ç”¨æˆ·IDéš”ç¦»

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åˆå§‹åŒ–æ•°æ®åº“è¡¨

è¿è¡Œä»¥ä¸‹ SQL åˆ›å»ºç”¨æˆ·è¡¨ï¼š

```sql
CREATE TABLE IF NOT EXISTS users (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    email VARCHAR(100),
    real_name VARCHAR(50),
    role VARCHAR(20) DEFAULT 'USER',
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP,
    INDEX idx_username (username)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 2. æ’å…¥æµ‹è¯•ç”¨æˆ·

```sql
-- ç®¡ç†å‘˜è´¦å·ï¼ˆç”¨æˆ·å: admin, å¯†ç : admin123ï¼‰
INSERT INTO users (username, password, email, real_name, role, created_at, updated_at)
VALUES ('admin', 'YWRtaW4xMjM=', 'admin@example.com', 'ç®¡ç†å‘˜', 'ADMIN', NOW(), NOW());

-- æ™®é€šç”¨æˆ·ï¼ˆç”¨æˆ·å: user1, å¯†ç : user123ï¼‰
INSERT INTO users (username, password, email, real_name, role, created_at, updated_at)
VALUES ('user1', 'dXNlcjEyMw==', 'user1@example.com', 'ç”¨æˆ·1', 'USER', NOW(), NOW());
```

æˆ–è€…ç›´æ¥è¿è¡Œåˆå§‹åŒ–è„šæœ¬ï¼š
```bash
mysql -uroot -p imts < springboot-backend/init-users-table.sql
```

### 3. å¯åŠ¨æœåŠ¡

ç¡®ä¿åç«¯å’Œå‰ç«¯éƒ½å·²å¯åŠ¨ï¼š
- åç«¯ï¼šhttp://localhost:8080
- å‰ç«¯ï¼šhttp://localhost:3000

### 4. è®¿é—®ç™»å½•é¡µé¢

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:3000

ç³»ç»Ÿä¼šè‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚

---

## ğŸ“ æµ‹è¯•è´¦å·

### ç®¡ç†å‘˜è´¦å·
- **ç”¨æˆ·å**: admin
- **å¯†ç **: admin123

### æ™®é€šç”¨æˆ·è´¦å·
- **ç”¨æˆ·å**: user1
- **å¯†ç **: user123

---

## ğŸ” ä½¿ç”¨æµç¨‹

### ç™»å½•æµç¨‹

1. **è®¿é—®ç³»ç»Ÿ**
   - æ‰“å¼€ http://localhost:3000
   - è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µé¢

2. **è¾“å…¥å‡­è¯**
   - è¾“å…¥ç”¨æˆ·åå’Œå¯†ç 
   - ç‚¹å‡»"ç™»å½•"æŒ‰é’®

3. **ç™»å½•æˆåŠŸ**
   - è‡ªåŠ¨è·³è½¬åˆ°ä»ªè¡¨ç›˜
   - é¡¶éƒ¨æ˜¾ç¤ºç”¨æˆ·åå’Œå¤´åƒ
   - å¯ä»¥æ­£å¸¸ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½

### æ³¨å†Œæµç¨‹

1. **åˆ‡æ¢åˆ°æ³¨å†Œæ ‡ç­¾**
   - åœ¨ç™»å½•é¡µé¢ç‚¹å‡»"æ³¨å†Œ"æ ‡ç­¾

2. **å¡«å†™æ³¨å†Œä¿¡æ¯**
   - ç”¨æˆ·åï¼ˆå¿…å¡«ï¼Œè‡³å°‘3ä¸ªå­—ç¬¦ï¼‰
   - å¯†ç ï¼ˆå¿…å¡«ï¼Œè‡³å°‘6ä¸ªå­—ç¬¦ï¼‰
   - é‚®ç®±ï¼ˆå¯é€‰ï¼‰
   - çœŸå®å§“åï¼ˆå¯é€‰ï¼‰

3. **æäº¤æ³¨å†Œ**
   - ç‚¹å‡»"æ³¨å†Œ"æŒ‰é’®
   - æ³¨å†ŒæˆåŠŸååˆ‡æ¢åˆ°ç™»å½•æ ‡ç­¾
   - ä½¿ç”¨æ–°è´¦å·ç™»å½•

### ç™»å‡ºæµç¨‹

1. **ç‚¹å‡»ç”¨æˆ·å¤´åƒ**
   - åœ¨é¡µé¢å³ä¸Šè§’ç‚¹å‡»ç”¨æˆ·å¤´åƒ

2. **é€‰æ‹©é€€å‡ºç™»å½•**
   - åœ¨ä¸‹æ‹‰èœå•ä¸­ç‚¹å‡»"é€€å‡ºç™»å½•"

3. **è¿”å›ç™»å½•é¡µ**
   - è‡ªåŠ¨æ¸…é™¤ç™»å½•ä¿¡æ¯
   - è·³è½¬åˆ°ç™»å½•é¡µé¢

---

## ğŸ” åŠŸèƒ½è¯´æ˜

### è·¯ç”±å®ˆå«

æ‰€æœ‰éœ€è¦ç™»å½•çš„é¡µé¢éƒ½å—åˆ°ä¿æŠ¤ï¼š
- `/dashboard` - ä»ªè¡¨ç›˜
- `/datasets` - æ•°æ®é›†ç®¡ç†
- `/tasks` - ä»»åŠ¡ç®¡ç†
- `/tasks/create` - åˆ›å»ºä»»åŠ¡
- `/tasks/:taskId` - ä»»åŠ¡è¯¦æƒ…

æœªç™»å½•è®¿é—®è¿™äº›é¡µé¢ä¼šè‡ªåŠ¨è·³è½¬åˆ° `/login`

### ç”¨æˆ·ä¿¡æ¯å­˜å‚¨

ç™»å½•æˆåŠŸåï¼Œç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨ localStorageï¼š
- `userId` - ç”¨æˆ·ID
- `username` - ç”¨æˆ·å
- `userInfo` - å®Œæ•´ç”¨æˆ·ä¿¡æ¯ï¼ˆJSONï¼‰

### è‡ªåŠ¨è·å–ç”¨æˆ·ID

æ‰€æœ‰é¡µé¢éƒ½ä¼šè‡ªåŠ¨ä» localStorage è·å–å½“å‰ç”¨æˆ·IDï¼š
```typescript
const userInfo = authStorage.getUser()
const userId = userInfo?.userId || 1
```

### æ•°æ®éš”ç¦»éªŒè¯

- ä¸Šä¼ æ•°æ®é›†ï¼šè‡ªåŠ¨å…³è”åˆ°å½“å‰ç”¨æˆ·
- æŸ¥è¯¢æ•°æ®é›†ï¼šåªæ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„æ•°æ®é›†
- åˆ é™¤æ•°æ®é›†ï¼šéªŒè¯æ‰€æœ‰æƒåæ‰èƒ½åˆ é™¤
- åˆ›å»ºä»»åŠ¡ï¼šè‡ªåŠ¨å…³è”åˆ°å½“å‰ç”¨æˆ·
- æŸ¥è¯¢ä»»åŠ¡ï¼šåªæ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„ä»»åŠ¡

---

## âš ï¸ å®‰å…¨è¯´æ˜

### å½“å‰å®ç°ï¼ˆå¼€å‘/æµ‹è¯•ç¯å¢ƒï¼‰

**å¯†ç åŠ å¯†æ–¹å¼**: Base64 ç¼–ç 
- âœ… ç®€å•æ˜“ç”¨
- âŒ ä¸å®‰å…¨ï¼Œå¯ä»¥è½»æ˜“è§£ç 
- âŒ ä»…é€‚åˆå¼€å‘å’Œæµ‹è¯•

**è®¤è¯æ–¹å¼**: åŸºäº localStorage
- âœ… å®ç°ç®€å•
- âŒ æ²¡æœ‰ Token è¿‡æœŸæœºåˆ¶
- âŒ æ²¡æœ‰åˆ·æ–° Token
- âŒ å®¹æ˜“è¢« XSS æ”»å‡»

### ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **ä½¿ç”¨ BCrypt åŠ å¯†å¯†ç **
```java
// æ·»åŠ ä¾èµ–
<dependency>
    <groupId>org.springframework.security</groupId>
    <artifactId>spring-security-crypto</artifactId>
</dependency>

// åŠ å¯†å¯†ç 
BCryptPasswordEncoder encoder = new BCryptPasswordEncoder();
String hashedPassword = encoder.encode(plainPassword);

// éªŒè¯å¯†ç 
boolean matches = encoder.matches(plainPassword, hashedPassword);
```

2. **ä½¿ç”¨ JWT Token**
```java
// ç”Ÿæˆ Token
String token = Jwts.builder()
    .setSubject(username)
    .claim("userId", userId)
    .setExpiration(new Date(System.currentTimeMillis() + 86400000)) // 24å°æ—¶
    .signWith(SignatureAlgorithm.HS512, secretKey)
    .compact();

// éªŒè¯ Token
Claims claims = Jwts.parser()
    .setSigningKey(secretKey)
    .parseClaimsJws(token)
    .getBody();
```

3. **é…ç½® Spring Security**
- æ·»åŠ  JWT è¿‡æ»¤å™¨
- é…ç½®è·¯ç”±æƒé™
- å®ç° Token åˆ·æ–°æœºåˆ¶

4. **å‰ç«¯å®‰å…¨æªæ–½**
- ä½¿ç”¨ HttpOnly Cookie å­˜å‚¨ Token
- å®ç° Token è‡ªåŠ¨åˆ·æ–°
- æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨è‡ªåŠ¨æºå¸¦ Token
- å¤„ç† Token è¿‡æœŸæƒ…å†µ

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. ç™»å½•åç«‹å³è·³è½¬å›ç™»å½•é¡µ

**åŸå› **: localStorage æ²¡æœ‰æ­£ç¡®ä¿å­˜ç”¨æˆ·ä¿¡æ¯

**è§£å†³**:
- æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’Œ localStorage
- é‡æ–°ç™»å½•

### 2. æ— æ³•æ³¨å†Œæ–°ç”¨æˆ·

**åŸå› **: ç”¨æˆ·åå·²å­˜åœ¨æˆ–æ•°æ®åº“è¿æ¥å¤±è´¥

**è§£å†³**:
- ä½¿ç”¨ä¸åŒçš„ç”¨æˆ·å
- æ£€æŸ¥åç«¯æ—¥å¿—
- ç¡®è®¤æ•°æ®åº“è¿æ¥æ­£å¸¸

### 3. çœ‹ä¸åˆ°å…¶ä»–ç”¨æˆ·çš„æ•°æ®

**è¯´æ˜**: è¿™æ˜¯æ­£å¸¸çš„ï¼ç³»ç»Ÿå®ç°äº†ç”¨æˆ·éš”ç¦»ï¼Œæ¯ä¸ªç”¨æˆ·åªèƒ½çœ‹åˆ°è‡ªå·±çš„æ•°æ®ã€‚

### 4. å¯†ç å¿˜è®°äº†æ€ä¹ˆåŠ

**ä¸´æ—¶æ–¹æ¡ˆ**: ç›´æ¥åœ¨æ•°æ®åº“ä¸­ä¿®æ”¹å¯†ç 
```sql
-- å°†å¯†ç é‡ç½®ä¸º newpass123
UPDATE users 
SET password = 'bmV3cGFzczEyMw==' 
WHERE username = 'your_username';
```

**ç”Ÿäº§ç¯å¢ƒ**: å®ç°"å¿˜è®°å¯†ç "åŠŸèƒ½ï¼Œé€šè¿‡é‚®ç®±é‡ç½®

---

## ğŸ“Š æ•°æ®åº“è¡¨ç»“æ„

### users è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | BIGINT | ä¸»é”®ï¼Œè‡ªå¢ |
| username | VARCHAR(50) | ç”¨æˆ·åï¼Œå”¯ä¸€ |
| password | VARCHAR(255) | å¯†ç ï¼ˆBase64ç¼–ç ï¼‰ |
| email | VARCHAR(100) | é‚®ç®± |
| real_name | VARCHAR(50) | çœŸå®å§“å |
| role | VARCHAR(20) | è§’è‰²ï¼ˆUSER/ADMINï¼‰ |
| created_at | TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMP | æ›´æ–°æ—¶é—´ |

---

## ğŸ”„ åç»­æ”¹è¿›è®¡åˆ’

### çŸ­æœŸï¼ˆ1å‘¨å†…ï¼‰
- [ ] å®ç°"è®°ä½æˆ‘"åŠŸèƒ½
- [ ] æ·»åŠ å¯†ç å¼ºåº¦éªŒè¯
- [ ] å®ç°ç”¨æˆ·èµ„æ–™ä¿®æ”¹

### ä¸­æœŸï¼ˆ1ä¸ªæœˆå†…ï¼‰
- [ ] ä½¿ç”¨ BCrypt åŠ å¯†å¯†ç 
- [ ] å®ç° JWT Token è®¤è¯
- [ ] æ·»åŠ  Token åˆ·æ–°æœºåˆ¶
- [ ] å®ç°"å¿˜è®°å¯†ç "åŠŸèƒ½

### é•¿æœŸï¼ˆ3ä¸ªæœˆå†…ï¼‰
- [ ] é…ç½® Spring Security
- [ ] å®ç°è§’è‰²æƒé™ç®¡ç†
- [ ] æ·»åŠ æ“ä½œæ—¥å¿—
- [ ] å®ç°å¤šå› ç´ è®¤è¯ï¼ˆMFAï¼‰

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [USER_ISOLATION_GUIDE.md](./USER_ISOLATION_GUIDE.md) - ç”¨æˆ·éš”ç¦»è¯¦ç»†è¯´æ˜
- [FRONTEND_GUIDE.md](./FRONTEND_GUIDE.md) - å‰ç«¯ä½¿ç”¨æŒ‡å—
- [springboot-backend/API_EXAMPLES.md](./springboot-backend/API_EXAMPLES.md) - API ä½¿ç”¨ç¤ºä¾‹

---

**ç‰ˆæœ¬**: 1.0.0  
**æ›´æ–°æ—¥æœŸ**: 2026-01-10  
**çŠ¶æ€**: âœ… å¯ç”¨ï¼ˆå¼€å‘/æµ‹è¯•ç¯å¢ƒï¼‰
